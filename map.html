<!DOCTYPE HTML>
<html>
<head>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico?">
</head>

<style>

.latlonbox {
   font:12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
   text-align: center;

}
.textarea {
   font:12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
   resize: none
}
.input {
   font:12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
}

.custom-popup .leaflet-popup-content {
    max-width: 1000px;
    max-height: 1000px;
    color: white;
  }
.custom-popup .leaflet-popup-content-wrapper {
  background:#2c3e50;
  font-size:16px;
  line-height:24px;
  max-width: 1000px;
  max-height: 1000px;
  }

</style>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
<body>
    <span class="textarea"><h3><b>Click on the map to add a point. See what others have said by clicking on markers.</b></h3></span>

  <div class='custom-popup' id='map' style="height: 75vh"></div>

  <div class="latlonbox" style='text-align:center'>
      <form>
	  <p>
	  <input type="text" class="blocktext" style="width: 350px; border:0px;" name="lat-lng" id="lat-lng" />
      </form>
  </div>
  <p>



  <script>
      var map = L.map('map', {tap: false}).setView([39, -100], 4);

	var Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	    attribution: 'Tiles &copy; Esri &mdash;'
	}).addTo(map);

	var positronLabels = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png', {
		attribution: '©OpenStreetMap, ©CartoDB',
	}).addTo(map);

        map.on('click', onMapClick);
        var marker0 = L.marker([47.01001273, -113.1427002]).addTo(map);		
var popup0 = marker0.bindPopup("Hi, I\'m testing from Chrome.")		
var marker1 = L.marker([46.64212967, -113.0932617]).addTo(map);		
var popup1 = marker1.bindPopup("Hi, I\'m testing from safari.")		
var marker2 = L.marker([47.03202127, -114.2578125]).addTo(map);		
var popup2 = marker2.bindPopup("Hi! Testing from mobile")		
var marker3 = L.marker([47.68497488, -122.3065531]).addTo(map);		
var popup3 = marker3.bindPopup("i like this house because it’s whet my family lives!!!!!!!!!")		
var marker4 = L.marker([47.00831484, -113.0740356]).addTo(map);		
var popup4 = marker4.bindPopup("Sure, no worries. I actually had no experience with any of that when I found your question -- I was trying to figure out how to do something similar at the time. So it was a good exercise for me to figure out how to do it, and much of my reason for answering was to document what I had discovered. Good that you were able to find such an effective alternate solution. :-)")		
var marker5 = L.marker([47.05112767, -112.9064941]).addTo(map);		
var popup5 = marker5.bindPopup("I am another test of the working website.")		
var marker6 = L.marker([48.85556385, -113.4558105]).addTo(map);		
var popup6 = marker6.bindPopup("hi")		
var marker7 = L.marker([41.05035952, -104.8535156]).addTo(map);		
var popup7 = marker7.bindPopup("middle of country")		
var marker8 = L.marker([37.57443916, -83.05664063]).addTo(map);		
var popup8 = marker8.bindPopup("awldne ")		
var marker9 = L.marker([46.13456717, -114.3347168]).addTo(map);		
var popup9 = marker9.bindPopup("ASSWIPES")		
var marker10 = L.marker([40.8452113, 14.30353684]).addTo(map);		
var popup10 = marker10.bindPopup("Naples!")

	function onMapClick(e) {
	    document.getElementById('lat-lng').value = 'you\'ve selected ' + e.latlng.lat + ", " + e.latlng.lng;
	    var popup = L.popup()
	    var lat = e.latlng.lat;
	    var lon = e.latlng.lng;
	    var lonForm = '<input type="hidden" name="longitude" value=' + lon + '>'
	    var latForm = '<input type="hidden" name="latitude" value=' + lat + '>'
	    var content = `
			  <form name="submit-to-google-sheet">
			  ` + lonForm + latForm + 
		          `
			    <textarea required class="textarea" name="message" rows="12" cols="40" placeholder=
			    "Tell me why this place is special to you!  It could be anywhere - a really good restaurant, a national park you've always wanted to visit, your home, a backpacking location, anything! There is no character limit, nor restriction on what you can write.
			    "
			    ></textarea>
			    <button class="textarea" type="submit">send!</button>
			  </form> 
		    `

	    var popLocation= e.latlng;
	    popup.setContent(content)
	    popup.setLatLng(popLocation);
	    popup.openOn(map);        

	    const scriptURL = 'https://script.google.com/macros/s/AKfycbyGBKwHWuznqh8qa3sQwQOugspaGsxdehKE-FXu_ICCrn8clJ1olAZ9KOTAFpwsCYl8AA/exec'
	    const form = document.forms['submit-to-google-sheet']

	    form.addEventListener('submit', e => {
		e.preventDefault();
		fetch(scriptURL, { method: 'POST', body: new FormData(form)})
		  .then(response => alert('entry submitted successfully :)'))
		  .catch(error => alert('uh oh.. something went wrong. Let tommy know.'))
	      });

	};

  </script>


  <div style="text-align:center;">
      <p>
      <figure>
      <img src="./woolly-mc.png" alt="a sheep.">
      <span style="font-size: 8">baa.</span>
      </figure>
  </div>


<div style="text-align:center;">
<span>
<a href="index.html" style="font-size: 8px">Back to home.</a>
</span>
</p>
</div>
</body>

</html>
